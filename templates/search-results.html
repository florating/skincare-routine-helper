{% extends 'base.html' %}

{% block title %}Skincare Products{% endblock %}

{% block body %}
  <div class="container">
    <div class="row">
      <div class="col d-flex justify-content-center">
        <a href="/products" class="lead backlink">
          Go back to the search form
        </a>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <div id="results-as-repr">
          <h2>Results:</h2>
          {% if product_list %}
            {% for item in product_list %}
            <pre>{{ item }}</pre>
            {% endfor %}
          {% else %}
            <p>There are no products to display.</p>
          {% endif %}
        </div>

        
        <div id="product-search-results">
          <h2>Product Search Results</h2>

          {% if not product_list %}
            <p>There are no products to display.</p>
          {% else %}
            <p>
              <span id="result-count">
                {{ product_list|length }}
              </span>
              products matched your search.
            </p>
            <div class="row">
              {# FIXME: change the wording for results shown #}
              {% if product_list|length > 10 %}
                Showing 10 of {{ product_list|length }} products.
              {% endif %}
            </div>

            <!-- FORM STARTS HERE -->
            <form id="add_to_cabinet" method="POST" action="/add_to_cabinet">
              <table class="product-list">
                <tr>
                  <td></td>
                  <td>Product</td>
                  <td>Product Type</td>
                  <!-- <td>Product Image</td> -->
                </tr>
                {% for item in product_list %}
                  <tr>
                    <td>
                      {% if item.product_id in current_cabinet %}
                      <!-- FIXME: add DOM stuff later -->
                        <input type="checkbox" class="product_id for_cabinet" name="product_id" value="{{ item['product_id'] }}" disabled="true">
                      {% else %}
                        <input type="checkbox" class="product_id for_cabinet" name="product_id" value="{{ item['product_id'] }}">
                      {% endif %}
                    </td>
                    <td>
                      <a href="/products/{{ item['product_id'] }}" target="_blank">
                        {{ item['product_name'] }}
                      </a>
                    </td>
                    <td>
                      {{ item['category']['category_name'] }}
                    </td>
                    <!-- <td>
                      <img id="product_id_{{ item['product_id'] }}" src="">
                    </td> -->
                  </tr>
                {% endfor %}
              </table>
              <input type="submit" value="Add to my cabinet!">
            </form>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block after_body %}{% endblock %}
